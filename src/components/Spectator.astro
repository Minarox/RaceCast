---
import Card from "@layouts/Card.astro";
---

<Card header="Spectateurs">
  <p id="spectator">Inconnu</p>
</Card>

<script>
    import { State } from "../types/state";

    const spectator: HTMLElement = document.getElementById("spectator") as HTMLElement;
    let status: boolean = false;

    document.addEventListener("participants", (event: any): void => {
        let count: number = parseInt(event.detail);
        if (isNaN(count) || count === 0) {
            count = 1;
        } else {
            count--;
        }
        spectator.textContent = `${count} ${status ? `en ligne${count > 1 ? 's' : ''}` : `en attente${count > 1 ? 's' : ''}`}`;
    });

    document.addEventListener("status", (event: any): void => {
        status = event.detail === State.CONNECTED;
    });
</script>
